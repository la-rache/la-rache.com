{{HEADER}}

<div id="certificat-wrap">
    <div id="certificat">
        <div class="certificat-header">
            <div class="palme"></div>
            <!-- https://svgsilh.com/image/2109235.html -->
            <h1>
                <div style="font-weight: lighter">Certificat de r√©ussite</div>
                <div style="font-size: 20px">
                    International Institute of La RACHE
                </div>
            </h1>
            <div class="palme"></div>
        </div>

        <div>100% de r√©ussite (ou presque) pour</div>
        <p>
            <input
                type="text"
                id="certif-name"
                spellcheck="false"
                placeholder="Pr√©nom NOM"
            />
            <script>
                // prettier-ignore
                document.getElementById("certif-name").addEventListener("input", () => {
                    const name = document.getElementById("certif-name").value;
                    history.replaceState("", "", window.location.pathname + (name ? `#${name}` : ""));
                });

                if (document.location.hash && document.location.hash !== "#") {
                    document.getElementById("certif-name").value = decodeURI(
                        document.location.hash.slice(1, document.location.hash.length) // prettier-ignore
                    );
                }
                setTimeout(() => {
                    (document.documentElement || document.body).scrollTo({
                        top: document.getElementById("certificat").offsetTop - 50, // prettier-ignore
                        behavior: "smooth",
                    });
                }, 300);
            </script>
        </p>
        <blockquote>
            Qui saura travailler dans des conditions √† peu pr√®s satisfaisantes
            pour un r√©sultat approximativement optimale.
        </blockquote>
        <p>
            Form√©(e) √† la caf√®t‚Äô, le&nbsp;<input
                type="date"
                onchange="this.nextElementSibling.textContent = this.valueAsDate.toLocaleDateString()"
            /><span></span>
            <!-- balise <span> √† cot√© du datepicker : pour cacher l'icone du 'datepicker' pendant le screenshot    -->
            <script>
                const dateInput = document.querySelector("input[type='date']");
                dateInput.valueAsDate = new Date();
                dateInput.nextElementSibling.textContent = dateInput.valueAsDate.toLocaleDateString(); //prettier-ignore
            </script>
        </p>

        <div class="certificat-footer">
            <div>
                <div>Le Pr√©sident</div>
                <strong>METODA Gilles</strong>
            </div>
            <div class="badge">
                <div class="badge-img"></div>
                <span class="badge-label">La R.A.C.H.E.</span>
            </div>
            <div>
                <div>Charg√©<span id="ee">e</span> de Formation</div>
                <strong>
                    L<span id="ea">a</span>
                    stagiaire
                </strong>
                <script>
                    // masculin || f√©minin
                    var xy = [Math.round(Math.random())];
                    document.getElementById("ea").textContent = ["e", "a"][xy];
                    document.getElementById("ee").textContent = ["", "e"][xy];
                </script>
            </div>
        </div>
        <div class="certificat-link">
            <a href="https://www.la-rache.com"> www.la-rache.com </a>
        </div>
    </div>
</div>

<style>
    #certificat {
        font-size: 1.2em;
        font-family: Superclarendon, "Bookman Old Style", "URW Bookman",
            "URW Bookman L", "Georgia Pro", Georgia, serif;
        text-align: center;
        max-width: 800px;
        margin: 0 auto;
        padding: 1em;

        background: linear-gradient(
            145deg,
            #dfc47f,
            #fbfaf6,
            #fbfaf6,
            #fbfaf6,
            #dfc47f
        );
        border: 5px solid #efe2a0;
        box-shadow: 0px 2px 15px 0px #b1822a;
    }

    .certificat-header {
        display: flex;
        justify-content: center;
        font-weight: bold;
    }

    .certificat-footer {
        display: flex;
        justify-content: space-around;
    }

    .palme {
        background: linear-gradient(
            to right,
            #bf953f,
            #fcf6ba,
            #b38728,
            #fbf5b7,
            #aa771c
        );
        -webkit-mask: url(img/palme.svg) no-repeat center / contain;
        -moz-mask: url(img/palme.svg) no-repeat center / contain;
        mask: url(img/palme.svg) no-repeat center/ contain;
        width: 80px;
    }

    .palme:first-child {
        transform: scaleX(-1);
    }

    .badge {
        position: relative;
    }

    .badge-img {
        -webkit-mask: url(img/badge.svg) no-repeat center / contain;
        -moz-mask: url(img/badge.svg) no-repeat center / contain;
        mask: url(img/badge.svg) no-repeat center / contain;
        width: 164px;
        height: 164px;
        background: linear-gradient(
            145deg,
            #bf953f,
            #fcf6ba,
            #b38728,
            #fbf5b7,
            #aa771c
        );
    }

    .badge-label {
        top: 70px;
        position: absolute;
        width: 100%;
        left: 0;
        color: white;
        font-size: 15px;
        font-weight: bold;
        text-shadow: -1px 1px 6px black;
    }

    /* dom2image.js n'aime pas les mask-image */
    .screenshot .palme {
        background: url(img/palme.png) no-repeat center;
        background-size: contain;
        -webkit-mask: none;
        -moz-mask: none;
        mask: none;
    }
    .screenshot .badge-img {
        background: url(img/badge.png) no-repeat center;
        background-size: contain;
        -webkit-mask: none;
        -moz-mask: none;
        mask: none;
    }

    input[type="date"],
    input[type="text"] {
        -webkit-appearance: none;
        appearance: none;
        border: none;
        font: inherit;
        background-color: transparent;
        padding: 0;
    }

    /* pour cacher l'input pendant le screenshot et surtout son icone 'datepicker' */
    input[type="date"],
    input[type="date"] + span {
        display: inline-block;
        height: 1.2em;
        margin: 0;
        padding: 0;
        width: 130px;
        text-align: left;
    }

    input[type="date"]::-webkit-inner-spin-button,
    input[type="date"]::-webkit-calendar-picker-indicator {
        display: none;
        -webkit-appearance: none;
        appearance: none;
    }

    input[type="date"] + span {
        display: none;
    }
    .screenshot input[type="date"] {
        display: none;
    }
    .screenshot input[type="date"] + span {
        display: inline-block;
    }

    #certificat p {
        display: flex;
        flex-direction: row;
        justify-content: center;
        align-items: center;
    }

    #certif-name {
        padding: 0 10px;
        font-family: "Segoe Print", "Bradley Hand", Chilanka, TSCu_Comic, casual,
            cursive;
        font-size: 2em;
        width: 100%;
        text-align: center;
    }

    .certificat-link {
        text-align: right;
    }

    .certificat-link a {
        color: black;
        text-decoration: underline;
    }
</style>

<script src="js/vendor/dom-to-image.min.js"></script>
<script>
    function download() {
        const certificat = document.getElementById("certificat-wrap");
        certificat.classList.add("screenshot");
        domtoimage
            .toJpeg(certificat, { quality: 0.95 })
            .then(function (dataUrl) {
                const link = document.createElement("a");
                link.download = `Certif_a_LARACHE_${document.getElementById("certif-name").value}.jpeg`; //prettier-ignore
                link.href = dataUrl;
                link.click();
            })
            .catch(function (error) {
                console.error("domtoimage", error);
                reject(error);
            })
            .finally(function () {
                certificat.classList.remove("screenshot");
            });
    }
</script>
<p class="certificat-actions">
    <button
        type="button"
        onclick="document.getElementById('certif-name').focus();document.getElementById('certif-name').select()"
    >
        <span>üñäÔ∏è</span> Modifier
    </button>
    &nbsp;

    <button
        onclick="navigator.share({
    title: `Certificat de l'International Institute of La RACHE de ${document.getElementById('certif-name').value}`,
    url : document.location.href,
  });"
    >
        <span>üì§</span> Partager au reste du monde
    </button>
    &nbsp;
    <button onclick="download()"><span>üì∏</span> Enregistrer</button>
</p>

<style>
    .certificat-actions {
        text-align: center;
    }
    .certificat-actions button {
        display: inline-flex;
        flex-direction: row;
        align-content: center;
        align-items: center;
        margin-bottom: 0.5em;
    }
    .certificat-actions button span {
        font-size: 1.5em;
        line-height: 1.5;
    }
</style>
{{FOOTER}}
